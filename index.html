<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Medição de Válvulas do Scania-550</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  /* Seu CSS mantém igual */
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
    line-height: 1.6;
    background-color: #d0f0c0;
  }
  h1, h2, h3 {
    color: #333;
    margin-top: 20px;
    margin-bottom: 10px;
  }
  h1 {
    font-size: 24px;
    text-align: center;
    border-bottom: 2px solid #333;
    padding-bottom: 10px;
  }
  h2 {
    font-size: 20px;
    margin-top: 30px;
    margin-bottom: 15px;
    text-align: center;
  }
  h3 {
    font-size: 16px;
    text-align: center;
    margin: 15px 0;
  }
  .valve-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    margin-bottom: 20px;
  }
  .valve-section {
    border: 1px solid #ddd;
    padding: 15px;
    margin-bottom: 20px;
    width: 32%;
    box-sizing: border-box;
    background-color: #ffffff;
  }
  .valve-type {
    font-weight: bold;
    margin-top: 10px;
    text-align: center;
    padding: 5px;
    border-radius: 4px;
  }
  .exaustao {
    background-color: #ffb84d;
    color: #333;
  }
  .admissao {
    background-color: #2e8b57;
    color: #fff;
  }
  .measurement {
    text-align: center;
    margin: 10px 0;
    font-size: 18px;
  }
  input[type="text"], input[type="date"], textarea {
    width: 120px;
    padding: 8px;
    text-align: center;
    font-size: 16px;
    border: 1px solid #ddd;
    border-radius: 4px;
  }
  textarea {
    width: 100%;
    height: 100px;
    padding: 10px;
    text-align: left;
    resize: vertical;
  }
  .info-table {
    width: 100%;
    margin-bottom: 20px;
  }
  .info-table td {
    padding: 5px 0;
    text-align: left;
  }
  .signature {
    margin-top: 50px;
    border-top: 1px solid #000;
    width: 320px;
    padding-top: 5px;
    text-align: center;
    font-weight: bold;
    font-size: 16px;
  }
  .warning {
    background-color: #fff3cd;
    padding: 10px;
    border-left: 4px solid #ffc107;
    margin: 15px 0;
    text-align: center;
  }
  .obs {
    margin-top: 30px;
    font-style: italic;
  }
  .button-container {
    margin-top: 20px;
    text-align: center;
  }
  button {
    background-color: #2e8b57;
    color: white;
    border: none;
    padding: 10px 20px;
    margin: 0 10px;
    font-size: 16px;
    border-radius: 4px;
    cursor: pointer;
  }
  button.clear-btn {
    background-color: #ff6b6b;
  }
  @media (max-width: 900px) {
    .valve-section {
      width: 100%;
    }
  }
</style>
</head>
<body>
<h1>MEDIÇÃO DAS VÁLVULAS DO SCANIA-550</h1>

<table class="info-table">
<tr>
<td><strong>MECÂNICO:</strong> <input type="text" id="mecanico" style="width: 200px;"></td>
<td><strong>DATA:</strong> <input type="date" id="data"></td>
</tr>
<tr>
<td><strong>USINA:</strong> <input type="text" id="usina" style="width: 200px;"></td>
<td><strong>HORÍMETRO:</strong> <input type="text" id="horimetro"></td>
</tr>
<tr>
<td><strong>SÉRIE:</strong> <input type="text" id="serie" style="width: 200px;"></td>
<td><strong>OS:</strong> <input type="text" id="os"></td>
</tr>
</table>

<div class="warning">
<h3>MEDIÇÕES ACEITÁVEIS: 64,00mm a 67,50mm</h3>
<h3>ACIMA DE 67,50mm DEVE SER CONSIDERADA SUBSTITUIÇÃO</h3>
</div>

<!-- Aqui seu conteúdo dos cilindros permanece igual -->

<div class="valve-container">
<!-- Cilindro 1 -->
<div class="valve-section">
<h2>MEDIDAS DO 1° CILINDRO</h2>
<div class="valve-type exaustao">VÁLVULAS EXAUSTÃO</div>
<div class="measurement"><input type="text" id="exaustao1_1" placeholder="mm"></div>
<div class="measurement"><input type="text" id="exaustao1_2" placeholder="mm"></div>
<div class="valve-type admissao">VÁLVULAS ADMISSÃO</div>
<div class="measurement"><input type="text" id="admissao1_1" placeholder="mm"></div>
<div class="measurement"><input type="text" id="admissao1_2" placeholder="mm"></div>
</div>
<!-- Cilindros 2, 3, 4, 5, 6 mantêm iguais ao seu código original -->
</div>

<div class="obs">
<p><strong>OBSERVAÇÕES:</strong></p>
<textarea id="observacoes"></textarea>
</div>

<div class="button-container">
<button id="generatePdf">Gerar PDF</button>
<button id="clearBtn" class="clear-btn">Limpar</button>
</div>

<div class="signature">
ASSINATURA DO MECÂNICO: _________________________
</div>

<script>
const { jsPDF } = window.jspdf;

document.getElementById('generatePdf').addEventListener('click', async () => {
  const img = new Image();
  img.src = 'background.jpg';
  img.crossOrigin = 'anonymous';

  await new Promise((resolve, reject) => {
    img.onload = resolve;
    img.onerror = () => {
      alert('Erro ao carregar a imagem de fundo!');
      reject();
    };
  });

  // Cria PDF com as dimensões da imagem (1180 x 1683 pixels)
  const pdf = new jsPDF({
    unit: 'px',
    format: [1180, 1683]
  });

  // Adiciona imagem no PDF, no tamanho real
  pdf.addImage(img, 'JPEG', 0, 0, 1180, 1683);

  pdf.setFont('helvetica', 'bold');
  pdf.setFontSize(20);
  pdf.setTextColor(0, 0, 0);

  function writeText(id, x, y) {
    const val = document.getElementById(id)?.value || '';
    pdf.text(val, x, y);
  }

  // Ajuste estas coordenadas conforme seu mapeamento visual:
  writeText('mecanico', 170, 210);
  writeText('usina', 170, 240);
  writeText('serie', 170, 270);
  writeText('os', 250, 290);

  const dataVal = document.getElementById('data').value;
  if (dataVal) {
    const dataFormat = new Date(dataVal).toLocaleDateString('pt-BR');
    pdf.text(dataFormat, 620, 230);
  }

  writeText('horimetro', 620, 260);

  const valves = [
    ['exaustao1_1', 180, 270], ['exaustao1_2', 180, 295], ['admissao1_1', 295, 270], ['admissao1_2', 295, 295],
    ['exaustao2_1', 420, 270], ['exaustao2_2', 420, 295], ['admissao2_1', 535, 270], ['admissao2_2', 535, 295],
    ['exaustao3_1', 660, 270], ['exaustao3_2', 660, 295], ['admissao3_1', 775, 270], ['admissao3_2', 775, 295],
    ['exaustao4_1', 180, 370], ['exaustao4_2', 180, 395], ['admissao4_1', 295, 370], ['admissao4_2', 295, 395],
    ['exaustao5_1', 420, 370], ['exaustao5_2', 420, 395], ['admissao5_1', 535, 370], ['admissao5_2', 535, 395],
    ['exaustao6_1', 660, 370], ['exaustao6_2', 660, 395], ['admissao6_1', 775, 370], ['admissao6_2', 775, 395],
  ];

  valves.forEach(([id, x, y]) => writeText(id, x, y));

  // Observações multiline
  const obs = document.getElementById('observacoes').value.split('\n');
  obs.forEach((linha, i) => {
    pdf.text(linha, 110, 450 + i * 25);
  });

  // Assinatura
  pdf.text('ASSINATURA DO MECÂNICO: _________________________', 100, 580);

  pdf.save('medicao-valvulas.pdf');
});

document.getElementById('clearBtn').addEventListener('click', () => {
  const inputs = document.querySelectorAll('input[type="text"], input[type="date"], textarea');
  inputs.forEach(input => input.value = '');
});
</script>
</body>
</html>
